# -*- coding: utf-8 -*-
"""
通用NLP信息提取模块
核心功能：按通用维度提取任意会议的核心信息，支持多模板适配
提取维度：通用基础+场景扩展，覆盖所有办公会议需求
仅Python语法编写，模拟大模型返回，无实际API调用
"""
from typing import List, Dict, Any

def extract_meeting_info(speech_list: List[Dict[str, Any]], template_type: str) -> Dict[str, Any]:
    """
    通用会议信息提取：适配所有会议类型，按模板返回结构化结果
    核心提取维度（通用基础，所有会议必含）+ 场景扩展维度（按模板补充）
    :param speech_list: 预处理后的结构化对话列表
    :param template_type: 选中的会议模板（通用商务/项目同步/需求评审/周例会）
    :return: 通用结构化提取结果，无行业/场景限制
    """
    # ====================== 通用基础维度（所有会议必含，核心）======================
    base_info = {
        "会议核心信息": {
            "主题": f"{template_type} - 核心事项讨论",
            "参与人": "未知（可从文本提取）",
            "会议时间": "未知（可从文本提取）",
            "会议时长": "未知（可从文本提取）",
            "核心议题": "未知（可从文本提取）"
        },
        "核心结论与共识": "会议达成的统一决策、核心共识、最终定论（通用）",
        "待办事项与责任人": "所有行动项、执行要求、责任人、截止时间（通用）",
        "问题与风险点": "会议提出的待解决问题、项目风险、执行难点（通用）",
        "下次会议安排": "下次会议时间、议题、参与人（通用，适配例会/项目会）"
    }

    # ====================== 场景扩展维度（按模板补充，通用化扩展）======================
    # 模板1：通用商务会议
    if template_type == "通用商务会议":
        base_info.update({
            "双方资源/诉求": "合作方/参会方的核心资源、需求、合作意向",
            "合作模式/规划": "短期合作动作、中长期合作规划、落地路径"
        })
    # 模板2：项目同步会议
    elif template_type == "项目同步会议":
        base_info.update({
            "项目当前进度": "各模块进度、完成率、关键节点达成情况",
            "资源需求与协调": "技术/人力/物料资源需求、跨部门协调事项",
            "后续执行计划": "阶段性目标、执行步骤、时间节点"
        })
    # 模板3：需求评审会议
    elif template_type == "需求评审会议":
        base_info.update({
            "需求核心内容": "待评审需求的背景、目标、核心功能、适用场景",
            "评审意见与结论": "各部门评审意见、需求通过/修改/驳回结论",
            "需求修改要求": "需求修改点、修改标准、提交流程与时间"
        })
    # 模板4：周度例会
    elif template_type == "周度例会":
        base_info.update({
            "本周工作完成情况": "各岗位本周工作成果、完成/未完成事项说明",
            "下周工作计划": "各岗位下周工作目标、核心任务、优先级",
            "工作难点与协助需求": "各岗位工作遇到的问题、需要的跨岗位协助"
        })

    # 模拟返回**通用结构化提取结果**（适配选中模板，无实际计算，保证逻辑闭环）
    # 项目同步会议示例（可根据template_type切换，此处为通用演示）
    extract_result = {
        "会议核心信息": {
            "主题": "XX项目同步会议 - 进度复盘与后续执行规划",
            "参与人": "主持人、技术负责人、产品负责人、测试负责人",
            "会议时间": "2026-XX-XX 15:00",
            "会议时长": "1小时",
            "核心议题": "项目开发进度复盘、测试用例交付、联调时间确认"
        },
        "项目当前进度": "核心功能开发完成80%，基础模块已联调，UI适配完成90%；未完成项：支付模块对接",
        "资源需求与协调": "技术侧需后端1名协助支付模块对接，测试侧需产品侧今日提供完整测试用例",
        "后续执行计划": "下周一开始全模块联调，下周三完成内部测试，下周五提测上线",
        "核心结论与共识": "1. 需求无变更，按原计划推进；2. 测试用例今日18点前发出；3. 下周五为既定上线时间",
        "待办事项与责任人": "1. 产品负责人：今日18点前输出测试用例；2. 技术负责人：下周完成联调；3. 测试负责人：下周三完成内部测试；4. 人力负责人：今日协调后端1名支持支付模块",
        "问题与风险点": "支付模块对接可能存在兼容性问题，需提前与第三方服务商沟通",
        "下次会议安排": "下周一10点召开项目联调启动会，参与人：技术/产品/测试负责人、第三方服务商"
    }

    return extract_result

# 通用测试（仅Python语法，无实际执行）
if __name__ == '__main__':
    test_speech = [{"time": "00:00:00", "speaker": "主持人", "content": "测试项目同步会议内容"}]
    # 测试不同模板
    print(extract_meeting_info(test_speech, "通用商务会议"))
    print(extract_meeting_info(test_speech, "项目同步会议"))